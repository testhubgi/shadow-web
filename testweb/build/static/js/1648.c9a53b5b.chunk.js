"use strict";(self.webpackChunkapp_web_react=self.webpackChunkapp_web_react||[]).push([[1648],{27074:function(e,t,a){a.d(t,{Z:function(){return g}});var n,r=a(1413),s=a(30168),i=a(72791),o=a(26686),l=a(18227),d=a(68500),c=a(96048),p=a.n(c),m=a(16444),u=a(70084),h=a(80184),f=(a(65785),a(70793)),v=function(e){var t=e.total,a=void 0===t?1:t,i=e.limit,c=void 0===i?10:i,v=e.setLimit,g=e.setPage,y=e.page,x=(e.setIsLoading,e.style),b=e.view,Z=void 0===b||b,w=Math.ceil(a/c),j=(0,m.ZP)(p()).attrs({activeClassName:"active"})(n||(n=(0,s.Z)(['\n    margin-bottom: 1rem;\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-end;\n    list-style-type: none;\n    padding: 0 1rem;\n    li a {\n      border-radius: 4px;\n      padding: 0.1rem 1rem;\n      cursor: pointer;\n      color: rgba(102, 102, 102, 1);\n      font-family: "Poppins_medium";\n      font-size: ',';\n    }\n    li.previous a,\n    li.next a,\n    li.break a {\n      border-color: transparent;\n      color: rgba(102, 102, 102, 1);\n      font-family: "Poppins_medium";\n      font-size: ',';\n    }\n    li.active a {\n      background-color: #7d2be9;\n      border-color: transparent;\n      color: white;\n      min-width: 24px;\n      font-family: "Poppins_medium";\n      font-size: ',";\n    }\n    li.disabled a {\n      color: rgba(102, 102, 102, 0.5);\n    }\n    li.disable,\n    li.disabled a {\n      cursor: default;\n    }\n  "])),(0,u.vw)(15),(0,u.vw)(15),(0,u.vw)(15));return(0,h.jsxs)(o.Z,{style:(0,r.Z)({boxShadow:"0px 0px 15px rgba(0, 0, 0, 0.1)",justifyContent:"space-between",alignItems:"center",height:(0,u.vh)(60),backgroundColor:"white"},x),children:[Z?(0,h.jsxs)(o.Z,{style:{alignItems:"center",paddingHorizontal:(0,u.vh)(20)},children:[(0,h.jsx)(l.Z,{style:{fontFamily:"Poppins_medium",fontSize:(0,u.vw)(15),color:"rgba(102, 102, 102, 1)",marginRight:(0,u.vw)(10)},children:"View"}),(0,h.jsxs)(d.Z,{outlineColor:"rgba(0,0,0.0.15)",outlineStyle:{borderWidth:(0,u.vh)(2)},variant:"outline",selectedValue:parseInt(c),style:{width:(0,u.vw)(50)},onValueChange:function(e){g(1),v(e)},dropdownIcon:(0,h.jsx)(f.Z,{}),children:[(0,h.jsx)(d.Z.Item,{label:"1",value:1}),(0,h.jsx)(d.Z.Item,{label:"5",value:5}),(0,h.jsx)(d.Z.Item,{label:"10",value:10}),(0,h.jsx)(d.Z.Item,{label:"20",value:20}),(0,h.jsx)(d.Z.Item,{label:"30",value:30}),(0,h.jsx)(d.Z.Item,{label:"40",value:40}),(0,h.jsx)(d.Z.Item,{label:"50",value:50}),(0,h.jsx)(d.Z.Item,{label:"100",value:100})]}),(0,h.jsx)(l.Z,{style:{fontFamily:"Poppins_medium",fontSize:(0,u.vw)(15),color:"rgba(102, 102, 102, 1)",marginLeft:(0,u.vw)(10)},children:"per page"})]}):(0,h.jsx)(o.Z,{}),(0,h.jsx)(j,{breakLabel:"...",nextLabel:"Next >",onPageChange:function(e){g(e.selected+1)},pageRangeDisplayed:3,marginPagesDisplayed:2,pageCount:w,previousLabel:"< Previous",renderOnZeroPageCount:null,forcePage:y-1})]})},g=i.memo(v)},678:function(e,t,a){var n=a(1413),r=(a(72791),a(69912)),s=a(82664),i=a(61134),o=a(70084),l=a(65785),d=a(80184);t.Z=function(e){return(0,d.jsxs)(r.NI,{isInvalid:e.invalid,style:(0,n.Z)({height:(0,o.vh)(48)},e.style),children:[e.label&&(0,d.jsx)(r.NI.Label,{style:{fontSize:(0,o.vw)(13),fontFamily:"Poppins_medium",color:e.invalid?"red.500":"rgba(102, 102, 102, 0.7)",height:(0,o.vh)(19)},children:e.label}),(0,d.jsx)(i.Qr,{control:e.control,rules:e.rules,name:e.name,render:function(t){var a=t.field,r=a.onChange;a.onBlur,a.value;return(0,d.jsx)(s.Z,(0,n.Z)((0,n.Z)({onTrackColor:l.Z.primary,style:{marginTop:(0,o.vh)(10)},size:"md"},e),{},{onToggle:function(t){e.isChanged(t),r(t)},colorScheme:"purple"}))}}),(0,d.jsx)(r.NI.ErrorMessage,{style:{marginTop:(0,o.vh)(-3)},children:e.error})]})}},65785:function(e,t){t.Z={primary:"rgba(125, 43, 233, 1)",accent:"#FFC107"}},71648:function(e,t,a){a.r(t),a.d(t,{default:function(){return M}});var n=a(74165),r=a(15861),s=a(70885),i=a(72791),o=a(74222),l=a(26686),d=a(18227),c=a(95417),p=a(60961),m=a(11638),u=a(25492),h=a(55045),f=a(68129),v=a(29996),g=a(59434),y=a(16871),x=a(70084),b=a(65785),Z=a(14071),w=a(69261),j=a(75247),C=a(80184),S=function(e){var t=e.item,a=e.setIsOpen,s=(0,g.I0)();return(0,C.jsx)(p.ZP,{onPress:(0,r.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({type:j.bl,data:t});case 2:a(!0);case 3:case"end":return e.stop()}}),e)}))),children:(0,C.jsxs)(o.Z,{style:{boxShadow:"0px 3px 10px #0000001A",width:(0,x.vw)(345),height:(0,x.vh)(100),marginHorizontal:(0,x.vw)(20),marginVertical:(0,x.vh)(10),borderRadius:(0,x.vw)(10),backgroundColor:"white"},children:[(0,C.jsx)(d.Z,{style:{marginHorizontal:(0,x.vw)(10),marginTop:(0,x.vh)(5),color:b.Z.primary,fontFamily:"Poppins_medium",fontSize:(0,x.vw)(15)},children:t.name}),(0,C.jsx)(d.Z,{style:{marginTop:(0,x.vh)(5),marginHorizontal:(0,x.vw)(10),color:"rgba(0,0,0, 0.5)",fontFamily:"Poppins",fontSize:(0,x.vw)(11)},children:t.description}),(0,C.jsxs)(l.Z,{style:{marginTop:(0,x.vh)(6),marginHorizontal:(0,x.vw)(10)},justifyContent:"space-between",children:[(0,C.jsx)(d.Z,{style:{color:"#686868",fontFamily:"Poppins",fontSize:(0,x.vw)(13)},children:t.send_mode}),(0,C.jsx)(p.ZP,{onPress:function(){},children:(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(13),fontFamily:"Poppins",color:b.Z.primary},children:t.default?t.team===t.createdUser._id?"Team Default":"Default":""})})]})]})})},P=i.memo(S),_=a(56798),k=a(42982),z=a(20520),T=a(61134),B=a(763),I=a.n(B),A=a(72426),E=a.n(A),L=a(79015),O=a(678),F=a(23093),H=a(93142),N=a(70793),q=a(44843),D=function(e){var t=e.isOpen,a=e.setIsOpen,v=e.templates,w=(0,m.S)({base:"base",sm:"sm",lg:"lg",md:"md",xl:"xl"}),j=(0,y.s0)(),S=(0,u.pm)(),P=(0,g.I0)(),_=i.useRef(null),B=i.useState(!1),A=(0,s.Z)(B,2),D=A[0],R=A[1],V=(0,i.useCallback)((function(){return a(!1)}),[a]),M=function(){return R(!1)},W=(0,i.useState)({header:"",desc:"",nolabel:"No",yeslabel:"Yes",yes:function(){},no:V}),Y=(0,s.Z)(W,2),G=Y[0],J=Y[1],K=(0,g.v9)((function(e){return e.campaigns})).currentCampaign,U=(0,i.useState)(K&&K.steps||[{active:!0,postcardtemplate:"not-send",postcardrepeat:!1,postcardevery:"",postcards:"",emailtemplate:"not-send",emailrepeat:!1,emailevery:"",emails:"",sendtime:""}]),X=(0,s.Z)(U,2),Q=X[0],$=X[1],ee=(0,i.useState)(!1),te=(0,s.Z)(ee,2),ae=te[0],ne=te[1],re=(0,i.useState)(!1),se=(0,s.Z)(re,2),ie=se[0],oe=se[1],le=(0,i.useState)(!1),de=(0,s.Z)(le,2),ce=de[0],pe=de[1],me=Q.find((function(e){return e.active})),ue=(0,T.cI)({mode:"onChange",defaultValues:I().isEmpty(K)?{name:"",description:"",default:!1,send_mode:"Attach Automatically",postcardtemplate:"not-send",postcardrepeat:!1,postcardevery:"",postcards:"",emailtemplate:"not-send",emailrepeat:!1,emailevery:"",emails:"",sendtime:""}:{name:K.name,description:K.description,default:K.default,send_mode:K.send_mode,postcardtemplate:me&&me.postcardtemplate?me.postcardtemplate:"not-send",postcardrepeat:!(!me||!me.postcardrepeat)&&me.postcardrepeat,postcardevery:me&&me.postcardevery?me.postcardevery:"",postcards:me&&me.postcards?me.postcards:"",emailtemplate:me&&me.emailtemplate?me.emailtemplate:"not-send",emailrepeat:!(!me||!me.emailrepeat)&&me.emailrepeat,emailevery:me&&me.emailevery?me.emailevery:"",emails:me&&me.emails?me.emails:"",sendtime:me&&me.sendtime?me.sendtime:""}}),he=ue.control,fe=ue.handleSubmit,ve=ue.formState.errors,ge=ue.getValues,ye=ue.setValue,xe=ue.trigger,be=ge("send_mode"),Ze=(0,i.useCallback)((function(e,t){S.show({placement:"top",render:function(){var a="red.300";return"error"===e?a="red.300":"success"===e?a="green.300":"info"===e?a="blueGray.300":"warning"===e&&(a="orange.300"),(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(12),fontFamily:"Poppins_medium",color:"#33214B"},p:2,bg:a,rounded:"full",children:t})}})}),[S]),we=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(t){var a,r,s,i,o,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a=Q.filter((function(e){return"not-send"===e.postcardtemplate&&"not-send"===e.emailtemplate})))&&a.length>0)){e.next=5;break}return Ze("error","No template selected in one of the steps."),oe(!1),e.abrupt("return");case 5:return r={name:t.name,description:t.description,default:t.default,send_mode:t.send_mode,steps:Q.map((function(e,t){return e.step=t+1,e}))},K&&K._id&&(r._id=K._id),s=K?Z.hm(r):Z.mK(r),i=!1,K&&(delete(o=K).active,delete o.team,delete o.createdUser,i=I().isEqual(o,r)),l=r._id?"Campaign updated successfully.":"Campaign created successfully.",e.prev=11,e.next=14,P(s);case 14:0,Ze("success",l),oe(!1),K?i?V():(J({header:"Attention!",desc:"Saved changes to the campaign take effect on newly added properties or to properties that you manually add/edit in campaign config.",nolabel:"Okay",yeslabel:"",yes:function(){},no:V}),R(!0)):V(),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(11),console.log("Created Error",e.t0),Ze("error",e.t0.message),oe(!1);case 25:case"end":return e.stop()}}),e,null,[[11,20]])})));return function(t){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){ie&&fe(we,(function(){oe(!1)}))()}),[ie]),(0,i.useEffect)((function(){"Attach Manually"===ge("send_mode")&&(ye("postcardrepeat",!1),xe("postcardrepeat"),ye("emailrepeat",!1),xe("emailrepeat"),pe(!0))}),[be,ge,ye,xe]),(0,i.useEffect)((function(){ce&&function(){var e=Q,t=e.findIndex((function(e){return!0===e.active}));e[t]={active:!0,postcards:ge&&ge("postcards")&&ge("postcards").toString(),postcardrepeat:ge&&ge("postcardrepeat"),postcardevery:ge&&ge("postcardevery")&&ge("postcardevery").toString(),postcardtemplate:ge&&ge("postcardtemplate"),emails:ge&&ge("emails")&&ge("emails").toString(),sendtime:ge&&ge("sendtime")&&ge("sendtime").toString(),emailrepeat:ge&&ge("emailrepeat")&&ge("emailrepeat"),emailevery:ge&&ge("emailevery")&&ge("emailevery").toString(),emailtemplate:ge&&ge("emailtemplate")},pe(!1),$(e)}()}),[ge,ce,Q]);var je=function(){var e=Q.filter((function(e){return!e.active})),t=e[e.length-1];e[e.length-1].active=!0,t.active=!0,ye("postcardtemplate",t.postcardtemplate?t.postcardtemplate:"not-send"),ye("emailtemplate",t.emailtemplate?t.emailtemplate:"not-send"),ye("postcardevery",t.postcardevery),ye("emailevery",t.emailevery),ye("postcards",t.postcards),ye("emails",t.emails),ye("sendtime",t.sendtime),$(e),Ze("success","Step deleted successfully."),R(!1)},Ce=function(){var e=(0,r.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!K||!K._id){e.next=14;break}return ne(!0),e.prev=2,t=Z.bO(K._id),e.next=6,P(t);case 6:Ze("success","Campaign deleted successfully."),j("/campaigns"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),"CAMPAIGN-ATTACHED"===e.t0.message?(J({header:"Sorry!",desc:"Cannot delete campaign used by one or more properties, you can only delete campaigns that are not assigned to any property.",nolabel:"Okay",yeslabel:"",yes:function(){},no:V}),a(!0)):Ze("err",e.t0.message),ne(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();if(0===v.length)return(0,C.jsxs)(h.Z,{flex:1,children:[(0,C.jsx)(d.Z,{children:"An error occurred!"}),(0,C.jsx)(z.z,{style:{color:b.Z.primary,margin:5,paddingHorizontal:5},onPress:function(){},children:(0,C.jsx)(d.Z,{style:{color:"white"},children:"No templates Found."})})]});var Se=[{name:"Not send mail",_id:"not-send",templatetype:"postcard"}].concat((0,k.Z)(v)).filter((function(e){return"postcard"===e.templatetype})).map((function(e){return{label:e.name,value:e._id}})),Pe=[{name:"Not send email",_id:"not-send",templatetype:"email"}].concat((0,k.Z)(v)).filter((function(e){return"email"===e.templatetype})).map((function(e){return{label:e.name,value:e._id}})),_e=["Attach Automatically","Attach Manually","Stop Sending"].map((function(e){return{label:e,value:e}})),ke=(0,k.Z)(Array(24).keys()).map((function(e){return{label:E()().startOf("day").add(e,"hours").format("HH:mm"),value:e.toString()}}));return ae?(0,C.jsx)(h.Z,{bg:"white",flex:1,children:(0,C.jsx)(f.Z,{size:"small",color:b.Z.primary})}):(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(o.Z,{bg:"white",mb:20,children:[(0,C.jsx)(q.default,{size:"xl",header:K&&K._id?"Edit Campaign":"Create Campaign",isOpen:t,close:function(){V()},isLoading:ie,save:function(){0===Object.keys(ve).length&&oe(!0)},footerStyle:{justifyContent:"space-between"},buttons:(0,C.jsxs)(l.Z,{justifyContent:"space-between",width:"100%",space:2,children:[(0,C.jsx)(l.Z,{justifyContent:"flex-start",space:2,children:(0,C.jsx)(H.default,{space:2,label:"base"===w||"sm"===w?"+":"Add Step",onPress:function(){"not-send"!==me.postcardtemplate||"not-send"!==me.emailtemplate?function(){var e="not-send",t="not-send",a=Q.map((function(e,t){return e.active=!1,e})).concat({active:!0,postcardtemplate:e,postcardrepeat:!1,postcardevery:"",postcards:"",emailtemplate:t,emailrepeat:!1,emailevery:"",emails:"",sendtime:""});ye("postcardtemplate",e),ye("emailtemplate",t),ye("postcardevery",""),ye("emailevery",""),ye("postcards",""),ye("emails",""),ye("sendtime",""),$(a)}():Ze("error","Please select a template in the current step to add a new one.")},style:{height:(0,x.vh)(36)}})}),(0,C.jsxs)(l.Z,{justifyContent:"flex-end",space:2,children:[K&&K._id&&(0,C.jsx)(H.default,{space:2,variant:"outline",label:"base"===w||"sm"===w?"X":"Delete",style:{height:(0,x.vh)(36),backgroundColor:"rgba(255,0,0,0.3)"},onPress:function(){J({header:"Delete!",desc:"Are you sure you want to delete this campaign?",nolabel:"No",yeslabel:"Yes",yes:Ce,no:M}),R(!0)}}),(0,C.jsx)(H.default,{space:2,color:b.Z.primary,variant:"outline",label:"Cancel",onPress:function(){V()},style:{height:(0,x.vh)(36)}}),(0,C.jsx)(H.default,{space:3,label:"Save",isLoading:ie,style:{height:(0,x.vh)(36)},onPress:function(){"not-send"!==me.postcardtemplate||"not-send"!==me.emailtemplate?0===Object.keys(ve).length&&oe(!0):Ze("error","Please select a template in the current step to save this campaign.")}})]})]}),children:(0,C.jsxs)(o.Z,{style:{zoom:"90%"},children:[(0,C.jsx)(l.Z,{space:4,style:{width:"base"===w||"sm"===w?"94vw":(0,x.vw)(612),justifyContent:"space-between",marginBottom:(0,x.vh)(20)},children:(0,C.jsx)(L.Z,{name:"name",label:"Campaign Name",placeholder:"Campaign Name",control:he,rules:{required:{value:!0,message:"Campaign name is required"}},invalid:!!ve.name,error:ve.name?ve.name.message:"",inputStyle:{}})}),(0,C.jsx)(l.Z,{space:4,style:{width:"base"===w||"sm"===w?"94vw":(0,x.vw)(612),justifyContent:"space-between",marginVertical:(0,x.vh)(20)},children:(0,C.jsx)(L.Z,{name:"description",label:"Campaign Description",placeholder:"Campaign Description",control:he,rules:{required:{value:!0,message:"Campaign Description is required"}},invalid:!!ve.description,error:ve.description?ve.description.message:"",inputStyle:{}})}),(0,C.jsxs)(l.Z,{space:4,style:{width:"base"===w||"sm"===w?"45.5vw":(0,x.vw)(300),justifyContent:"space-between",marginTop:(0,x.vh)(20),marginBottom:(0,x.vh)(40)},children:[(0,C.jsx)(F.Z,{control:he,items:_e,name:"send_mode",label:"Attach Mode",placeholder:"Select attach mode",invalid:!!ve.name,error:ve.name?ve.name.message:"",rules:{required:{value:!0,message:"Select attach mode"}}}),(0,C.jsx)(O.Z,{type:"switch",control:he,isChanged:function(e){ye("default",e),xe("default")},id:"default",name:"default",label:"Default campaign? ",isChecked:ge("default"),invalid:!!ve.default,error:ve.default?ve.default.message:"",rules:{}})]}),Q.map((function(e,t){return(0,C.jsxs)(o.Z,{rounded:"md",style:{boxShadow:"0px 3px 5px #0000001A",backgroundColor:!1===e.active?"#eeeeee":"#fff",marginVertical:(0,x.vh)(10),paddingHorizontal:(0,x.vh)(20),paddingVertical:(0,x.vh)(10),width:"base"===w||"sm"===w?"94vw":(0,x.vw)(612)},children:[(0,C.jsx)(p.ZP,{onPress:function(){!function(e){if(1!==Q.length||K){var t=Q.map((function(t,a){return a===e?(ye("postcardtemplate",t.postcardtemplate?t.postcardtemplate:"not-send"),ye("emailtemplate",t.emailtemplate?t.emailtemplate:"not-send"),ye("postcardrepeat",!!t.postcardrepeat&&t.postcardrepeat),ye("postcardevery",t.postcardevery?t.postcardevery:""),ye("postcards",t.postcards?t.postcards:""),ye("emailrepeat",!!t.emailrepeat&&t.emailrepeat),ye("emailevery",t.emailevery?t.emailevery:""),ye("emails",t.emails?t.emails:""),ye("sendtime",t.sendtime?t.sendtime:""),xe(),t.active=!t.active,t.postcardtemplate||(t.postcardtemplate="not-send"),t):(t.active=!1,t)}));$(t)}}(t)},style:{marginBottom:e.active?(0,x.vh)(10):0},children:(0,C.jsxs)(l.Z,{py:1,style:{borderBottomWidth:e.active?(0,x.vw)(2):0,borderBottomColor:"rgba(0,0,0, 0.15)",justifyContent:"space-between"},children:[(0,C.jsxs)(d.Z,{style:{marginLeft:5,fontFamily:"Poppins",fontSize:16,color:b.Z.primary},children:["Step ",t+1]}),(0,C.jsx)(h.Z,{children:(0,C.jsx)(N.Z,{})})]})}),!0===e.active&&(0,C.jsxs)(o.Z,{marginBottom:1===Q.length?(0,x.vh)(10):0,children:[(0,C.jsxs)(l.Z,{space:4,style:{width:"base"===w||"sm"===w?"40vw":(0,x.vw)(280),justifyContent:"space-between",marginBottom:(0,x.vh)(10)},children:[(0,C.jsx)(F.Z,{control:he,items:Se,name:"postcardtemplate",id:"postcardtemplate",label:"Send mail with template",placeholder:"Select mail template",onChange:function(e){ye("postcardtemplate",e),xe("postcardtemplate"),ye("postcardrepeat",!1),xe("postcardrepeat"),pe((function(e){return!e}))},invalid:!!ve.postcardtemplate,error:ve.postcardtemplate?ve.postcardtemplate.message:"",rules:{required:{value:!0,message:"Please select a mail template"}}}),(0,C.jsx)(O.Z,{isDisabled:"not-send"===e.postcardtemplate||"Attach Manually"===ge("send_mode"),control:he,isChanged:function(e){ye("postcardrepeat",e),xe("postcardrepeat"),pe(!0)},id:"postcardrepeat",name:"postcardrepeat",label:"Repeat mail Sending? ",isChecked:e.postcardrepeat,invalid:!!ve.postcardrepeat,error:ve.postcardrepeat?ve.postcardrepeat.message:"",rules:{}})]}),!0===e.postcardrepeat&&(0,C.jsxs)(l.Z,{space:4,style:{width:"base"===w||"sm"===w?"40vw":(0,x.vw)(280),justifyContent:"space-between",marginVertical:(0,x.vh)(10)},children:[(0,C.jsx)(L.Z,{suffix:"Day(s)",control:he,id:"postcardevery",name:"postcardevery",label:"base"===w||"sm"===w?"Repeat sending":"Repeat sending every (in days)",placeholder:"21",maxLength:3,onChangeText:function(e){pe(!0)},invalid:!!ve.postcardevery,error:ve.postcardevery?ve.postcardevery.message:"",rules:{required:{value:!0,message:"Mail repeat period is required"}}}),(0,C.jsx)(L.Z,{control:he,id:"postcards",name:"postcards",label:"Mails to send (in nos.) ",placeholder:"8",maxLength:4,required:!0,onChangeText:function(e){pe(!0)},invalid:!!ve.postcards,error:ve.postcards?ve.postcards.message:"",rules:{required:{value:!0,message:"Mails to send is required"}}})]}),(0,C.jsxs)(l.Z,{space:4,style:{width:"base"===w||"sm"===w?"40vw":(0,x.vw)(280),justifyContent:"space-between",marginTop:(0,x.vh)(20),marginBottom:(0,x.vh)(10)},children:[(0,C.jsx)(F.Z,{control:he,items:Pe,name:"emailtemplate",id:"emailtemplate",label:"base"===w||"sm"===w?"Send template":"Send e-mail with template",placeholder:"Select e-mail template",onChange:function(e){ye("emailtemplate",e),xe("emailtemplate"),ye("emailrepeat",!1),xe("emailrepeat"),pe((function(e){return!e}))},invalid:!!ve.emailtemplate,error:ve.emailtemplate?ve.emailtemplate.message:"",rules:{required:{value:!0,message:"Select an email template"}}}),(0,C.jsx)(O.Z,{isDisabled:"not-send"===e.emailtemplate,control:he,isChanged:function(e){ye("emailrepeat",e),xe("emailrepeat"),pe(!0)},id:"emailrepeat",name:"emailrepeat",label:"Repeat e-mail sending? ",isChecked:e.emailrepeat,invalid:!!ve.emailrepeat,error:ve.emailrepeat?ve.emailrepeat.message:"",rules:{}})]}),!0===e.emailrepeat&&"not-send"!==e.emailtemplate&&(0,C.jsxs)(l.Z,{space:4,style:{width:"base"===w||"sm"===w?"40vw":(0,x.vw)(280),justifyContent:"space-between",marginTop:(0,x.vh)(10),marginBottom:(0,x.vh)(20)},children:[(0,C.jsx)(L.Z,{suffix:"Day(s)",control:he,id:"emailevery",name:"emailevery",label:"base"===w||"sm"===w?"Repeat sending":"Repeat sending every (in days)",placeholder:"21",maxLength:3,required:!0,onChangeText:function(e){pe(!0)},invalid:!!ve.emailevery,error:ve.emailevery?ve.emailevery.message:"",rules:{required:{value:!0,message:"Repeat email every period is required"}}}),(0,C.jsx)(c._,{from:"md",children:(0,C.jsx)(L.Z,{suffix:"Nos(s)",control:he,id:"emails",name:"emails",label:"Emails to send (in nos.)",placeholder:"8",maxLength:4,onChangeText:function(e){pe(!0)},invalid:!!ve.emails,error:ve.emails?ve.emails.message:"",rules:{required:{value:!0,message:"Email to send is required"}}})}),(0,C.jsx)(c._,{only:["base","sm"],children:(0,C.jsx)(l.Z,{space:2,children:(0,C.jsx)(L.Z,{style:{width:"34%"},suffix:"Nos(s)",control:he,id:"emails",name:"emails",label:"Emails to send (nos.)",placeholder:"8",maxLength:4,onChangeText:function(e){pe(!0)},invalid:!!ve.emails,error:ve.emails?ve.emails.message:"",rules:{required:{value:!0,message:"Email to send is required"}}})})})]}),(0,C.jsx)(F.Z,{style:{width:"24%",marginTop:10,marginBottom:20},sameline:!0,suffix:" ",control:he,type:"select",items:ke,name:"sendtime",id:"sendtime",label:"Send Time",placeholder:"Select send time",onChange:function(e){pe(!0)},invalid:!!ve.sendtime,error:ve.sendtime?ve.sendtime.message:"",rules:{required:{value:!0,message:"Select send time"}}})]}),Q.length>1&&e.active&&(0,C.jsx)(h.Z,{style:{alignItems:"flex-end",paddingVertical:10,paddingRight:25},children:(0,C.jsx)(d.Z,{style:{color:"red",fontSize:10},onPress:function(){J({header:"Delete?",desc:"Are you sure you want to delete this Step?",nolabel:"No",yeslabel:"Yes",yes:je,no:V}),R(!0)},children:"Remove Step"})})]},"step"+t)}))]})}),(0,C.jsx)(q.default,{size:"md",isOpen:D,close:M,header:G.header,buttons:(0,C.jsxs)(l.Z,{space:2,children:[(0,C.jsx)(H.default,{space:3,variant:"outline",label:G.nolabel,onPress:G.no,ref:_}),G.yeslabel&&(0,C.jsx)(H.default,{space:3,label:G.yeslabel,onPress:G.yes})]}),children:(0,C.jsx)(d.Z,{style:{fontFamily:"Poppins",fontSize:(0,x.vw)(13),color:"rgba(0,0,0,0.8)"},children:G.desc})})]})})},R=a(27074),V=function(e){e.listStyle,e.setListStyle;var t=e.navigate,a=e.setIsOpen,m=e.dispatch,u=e._showAlert,h=e.templates,f=(0,i.useState)(!1),v=(0,s.Z)(f,2),g=v[0],y=v[1];return(0,C.jsxs)(o.Z,{style:{marginHorizontal:(0,x.vw)(20),borderBottomColor:"rgba(0,0,0,0.15)",borderBottomWidth:1,marginTop:(0,x.vh)(-10)},children:[(0,C.jsxs)(l.Z,{justifyContent:"space-between",children:[(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(24),paddingTop:(0,x.vh)(30),width:(0,x.vw)(300),color:"#303030",fontFamily:"Poppins_medium",justifyContent:"flex-start"},children:"Campaigns"}),(0,C.jsx)(c._,{only:["sm","base"],children:(0,C.jsxs)(l.Z,{alignSelf:"center",children:[(0,C.jsx)(p.ZP,{onPress:function(){t("/campaigns")},children:(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(15),paddingTop:(0,x.vh)(40),paddingHorizontal:10,color:b.Z.primary,fontFamily:"Poppins_medium",marginHorizontal:(0,x.vw)(25),paddingBottom:(0,x.vh)(13),borderBottomWidth:(0,x.vh)(4),borderBottomColor:"rgba(125, 43, 233, 1)"},children:"Campaigns"})}),(0,C.jsx)(p.ZP,{onPress:function(){t("/templates")},children:(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(15),paddingTop:(0,x.vh)(40),paddingHorizontal:10,color:"#303030",fontFamily:"Poppins_medium",marginHorizontal:(0,x.vw)(25),paddingBottom:(0,x.vh)(13),borderBottomWidth:(0,x.vh)(0),borderBottomColor:"rgba(125, 43, 233, 1)"},children:"Templates"})}),(0,C.jsx)(p.ZP,{onPress:function(){t("/signatures")},children:(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(15),paddingTop:(0,x.vh)(40),paddingHorizontal:10,color:"#303030",fontFamily:"Poppins_medium",marginHorizontal:(0,x.vw)(25),paddingBottom:(0,x.vh)(13),borderBottomWidth:(0,x.vh)(0),borderBottomColor:"rgba(125, 43, 233, 1)"},children:"Signatures"})})]})}),(0,C.jsx)(l.Z,{style:{marginTop:(0,x.vh)(20),width:(0,x.vw)(300)},alignItems:"center",justifyContent:"flex-end",space:2,children:(0,C.jsx)(H.default,{onPress:(0,r.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h||0!==h.length){e.next=4;break}y(!0),e.next=13;break;case 4:return e.prev=4,e.next=7,m({type:j.bl,data:null});case 7:a(!0),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),u("error",e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[4,10]])}))),label:"+ Create",style:{height:(0,x.vh)(36)}})})]}),(0,C.jsx)(c._,{from:"md",children:(0,C.jsxs)(l.Z,{alignSelf:"center",children:[(0,C.jsx)(p.ZP,{onPress:function(){t("/campaigns")},children:(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(15),paddingTop:(0,x.vh)(20),paddingHorizontal:10,color:b.Z.primary,fontFamily:"Poppins_medium",marginHorizontal:(0,x.vw)(10),paddingBottom:(0,x.vh)(13),borderBottomWidth:(0,x.vh)(4),borderBottomColor:"rgba(125, 43, 233, 1)"},children:"Campaigns"})}),(0,C.jsx)(p.ZP,{onPress:function(){t("/templates")},children:(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(15),paddingTop:(0,x.vh)(20),paddingHorizontal:10,color:"#303030",fontFamily:"Poppins_medium",marginHorizontal:(0,x.vw)(10),paddingBottom:(0,x.vh)(13),borderBottomWidth:(0,x.vh)(0),borderBottomColor:"rgba(125, 43, 233, 1)"},children:"Templates"})}),(0,C.jsx)(p.ZP,{onPress:function(){t("/signatures")},children:(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(15),paddingTop:(0,x.vh)(20),paddingHorizontal:10,color:"#303030",fontFamily:"Poppins_medium",marginHorizontal:(0,x.vw)(10),paddingBottom:(0,x.vh)(13),borderBottomWidth:(0,x.vh)(0),borderBottomColor:"rgba(125, 43, 233, 1)"},children:"Signatures"})})]})}),(0,C.jsx)(q.default,{size:"md",isOpen:g,header:"Attention!",close:function(){y(!1)},buttons:(0,C.jsxs)(l.Z,{space:2,children:[(0,C.jsx)(H.default,{space:2,onPress:function(){y(!1)},label:"Cancel",variant:"outline",color:b.Z.primary,style:{height:(0,x.vh)(36)}}),(0,C.jsx)(H.default,{space:2,onPress:function(){t("/templates")},label:"Add Template",style:{height:(0,x.vh)(36)}})]}),children:(0,C.jsx)(d.Z,{style:{fontFamily:"Poppins",fontSize:(0,x.vw)(15),color:"rgba(0,0,0,0.8)"},children:"You need a template to add a campaign"})})]})},M=function(e){var t=e.user,a=e.setLogout,l=(0,g.I0)(),c=(0,y.s0)(),p=(0,m.S)({base:"base",sm:"sm",lg:"lg",md:"md",xl:"xl"}),j=(0,u.pm)(),S=(0,i.useState)(50),k=(0,s.Z)(S,2),z=k[0],T=k[1],B=i.useState(!1),I=(0,s.Z)(B,2),A=I[0],E=I[1],L=(0,i.useState)("vertical"),O=(0,s.Z)(L,2),F=O[0],H=O[1],N=(0,i.useState)(!1),q=(0,s.Z)(N,2),M=q[0],W=q[1],Y=(0,i.useState)(!1),G=(0,s.Z)(Y,2),J=G[0],K=G[1],U=(0,i.useState)(!1),X=(0,s.Z)(U,1)[0],Q=(0,i.useState)(1),$=(0,s.Z)(Q,2),ee=$[0],te=$[1],ae=(0,g.v9)((function(e){return e.campaigns})),ne=ae.userCampaigns,re=ae.total,se=(0,g.v9)((function(e){return e.templates.userTemplates})),ie=(0,i.useCallback)((function(e,t){j.closeAll(),j.show({placement:"top",duration:1e3,render:function(){var a="red.300";return"error"===e?a="red.300":"success"===e?a="green.300":"info"===e?a="blueGray.300":"warning"===e&&(a="orange.300"),(0,C.jsx)(d.Z,{style:{fontSize:(0,x.vw)(12),fontFamily:"Poppins_medium",color:"#33214B"},p:2,bg:a,rounded:"full",children:t})}})}),[j]);(0,i.useEffect)((function(){(0,r.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(w.pK(1,1e3));case 2:case"end":return e.stop()}}),e)})))()}),[l]);var oe=(0,i.useCallback)((0,r.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),e.prev=1,e.next=4,l(Z.DW(ee,z));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),ie("error",e.t0.message);case 9:K(!1);case 10:case"end":return e.stop()}}),e,null,[[1,6]])}))),[l,ie,ee,z]);(0,i.useEffect)((function(){return W(!0),oe().then((function(){W(!1)})),function(){W(!1),K(!1)}}),[l,oe,ee]);var le=function(){return(0,C.jsx)(h.Z,{mt:250,flex:1,children:(0,C.jsx)(d.Z,{children:"No items found."})})},de=100-parseFloat((0,x.vh)(70))+"vh",ce=Math.floor(window.screen.width/250);return 0===ce&&(ce=1),(0,C.jsxs)(o.Z,{style:{minHeight:"100vh"},bg:"white",flex:1,children:[(0,C.jsx)(_.default,{user:t,setLogout:a}),(0,C.jsxs)(o.Z,{height:de,children:[(0,C.jsx)(V,{templates:se,navigate:c,setListStyle:H,listStyle:F,setIsOpen:E,dispatch:l,_showAlert:ie}),M?(0,C.jsx)(h.Z,{flex:1,children:(0,C.jsx)(f.Z,{size:"small",color:b.Z.primary})}):(0,C.jsxs)(C.Fragment,{children:[1===ce?(0,C.jsx)(v.O,{style:{marginLeft:"base"===p||"sm"===p?(0,x.vw)(-10):0},contentContainerStyle:{paddingBottom:20},ListEmptyComponent:(0,C.jsx)(le,{}),refreshing:J,removeClippedSubviews:!0,data:ne,keyExtractor:function(e){return e._id},renderItem:function(e){var t=e.item;return(0,C.jsx)(P,{cols:ce,item:t,setIsOpen:E,setShowPreview:X})}},"list-"+ce):(0,C.jsx)(v.O,{style:{marginLeft:"base"===p||"sm"===p?(0,x.vw)(-10):0},contentContainerStyle:{paddingBottom:20},ListEmptyComponent:(0,C.jsx)(le,{}),refreshing:J,removeClippedSubviews:!0,data:ne,keyExtractor:function(e){return e._id},renderItem:function(e){var t=e.item;return(0,C.jsx)(P,{cols:ce,item:t,setIsOpen:E,setShowPreview:X})},columnWrapperStyle:{justifyContent:ne.length>5?"space-between":"flex-start"},numColumns:5},"list-"+ce),re>z&&(0,C.jsx)(R.Z,{limit:z,total:re,page:ee,setPage:te,setIsLoading:W,setLimit:T})]}),A&&(0,C.jsx)(D,{isOpen:A,setIsOpen:E,templates:se})]})]})}},69261:function(e,t,a){a.d(t,{Xc:function(){return d},Xu:function(){return c},pK:function(){return l}});var n=a(42982),r=a(74165),s=a(15861),i=a(4200),o=a(75247),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return function(){var a=(0,s.Z)((0,r.Z)().mark((function a(n,s){var l,d,c,p,m,u,h,f,v,g;return(0,r.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=(0,i.PR)(),d=l.team,c=l.token,p=s().campaigns.userCampaigns,m=p&&p.length>0&&p.find((function(e){return e.createdUser._id===d})),u={skip:1===e?0:(e-1)*t,limit:t},m&&(h=[],m&&m.steps&&m.steps.map((function(e){return e.emailtemplate&&h.push(e.emailtemplate),e.postcardtemplate&&h.push(e.postcardtemplate),e})),h.length>0&&(u.filter={templates:h})),a.prev=5,a.next=8,fetch("".concat(i.T5,"/templates/get"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+c},body:JSON.stringify(u)});case 8:if((f=a.sent).ok){a.next=14;break}return a.next=12,f.json();case 12:v=a.sent,console.log(v);case 14:return a.next=16,f.json();case 16:g=a.sent,n({type:o.N_,data:g.data?g.data:[],total:g.count?g.count:0}),a.next=24;break;case 20:throw a.prev=20,a.t0=a.catch(5),console.log("Error ",a.t0),a.t0;case 24:case"end":return a.stop()}}),a,null,[[5,20]])})));return function(e,t){return a.apply(this,arguments)}}()},d=function(e){return function(){var t=(0,s.Z)((0,r.Z)().mark((function t(a,n){var s,l,d,c,p;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=(0,i.PR)(),l=s.token,d=n().templates.userTemplates,t.next=5,fetch("".concat(i.T5,"/templates/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+l},body:JSON.stringify({active:!1})});case 5:if((c=t.sent).ok){t.next=8;break}throw new Error("Something went wrong!");case 8:return t.next=10,c.json();case 10:if(!(p=t.sent).data){t.next=16;break}return d&&d.length>0&&(d=d.filter((function(e){return e._id!==p.data._id}))),t.next=15,a({type:o.N_,data:d});case 15:return t.abrupt("return",!0);case 16:return t.abrupt("return",!1);case 19:throw t.prev=19,t.t0=t.catch(0),console.log(t.t0),new Error(t.t0.message);case 23:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e,a){return t.apply(this,arguments)}}()},c=function(e){return function(){var t=(0,s.Z)((0,r.Z)().mark((function t(a,s){var l,d,c,p,m,u,h,f,v,g;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=(0,i.PR)(),d=l.token,c=s().templates.userTemplates,p=e._id,m="".concat(i.T5,"/templates/add"),u="POST",p&&(m="".concat(i.T5,"/templates/").concat(p),delete e._id,u="PATCH"),t.prev=6,t.next=9,fetch(m,{method:u,headers:{"Content-Type":"application/json",Authorization:"Bearer "+d},body:JSON.stringify(e)});case 9:if((h=t.sent).ok){t.next=17;break}return t.next=13,h.json();case 13:throw f=t.sent,v="Something went wrong!",f&&f.error&&(v=f.error),new Error(v);case 17:return t.next=19,h.json();case 19:(g=t.sent).data&&(c=p?c.map((function(e){return e._id===g.data._id&&(e=g.data),e})):[].concat((0,n.Z)(c),[g.data]),a({type:o.N_,data:c})),t.next=27;break;case 23:throw t.prev=23,t.t0=t.catch(6),console.log(t.t0),new Error(t.t0.message);case 27:case"end":return t.stop()}}),t,null,[[6,23]])})));return function(e,a){return t.apply(this,arguments)}}()}}}]);
//# sourceMappingURL=1648.c9a53b5b.chunk.js.map
{"version":3,"file":"static/js/9675.071b5548.chunk.js","mappings":"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","sources":["pages/private/home/index.js","store/actions/auth.js","../node_modules/uuid/dist/esm-browser/rng.js","../node_modules/uuid/dist/esm-browser/regex.js","../node_modules/uuid/dist/esm-browser/stringify.js","../node_modules/uuid/dist/esm-browser/validate.js","../node_modules/uuid/dist/esm-browser/v4.js"],"sourcesContent":["import React, { useState, useEffect, Suspense } from \"react\";\r\nimport { VStack } from \"native-base\";\r\nimport _ from \"lodash\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nimport * as authActions from \"../../../store/actions/auth\";\r\n\r\nconst NavBar = React.lazy(() => import(\"./NavBar\"));\r\nconst Map = React.lazy(() => import(\"./Map\"));\r\n\r\nconst GOOGLE_API_KEY = \"AIzaSyDmwZdL8fB-zBbuBfm6cXl_IgaMvkH-KLE\";\r\n\r\nconst Index = ({ setLogout, user }) => {\r\n  const dispatch = useDispatch();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [predictions, setPredictions] = useState([]);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (user) {\r\n        await dispatch(authActions.getProfile());\r\n        // await dispatch(pipelineActions.fetchPipelines());\r\n        // await dispatch(mapsActions.fetchStateProperties());\r\n        // await dispatch(mapsActions.fetchZipProperties());\r\n      }\r\n    })();\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    let unmounted = false;\r\n    const getLocations = _.debounce(async (loc) => {\r\n      const url = `https://maps.googleapis.com/maps/api/place/autocomplete/json?key=${GOOGLE_API_KEY}&input=${loc}&radius=2000&components=country:us`;\r\n      try {\r\n        const result = await fetch(url);\r\n        const json = await result.json();\r\n        setPredictions(json.predictions);\r\n      } catch (err) {\r\n        console.error(err.message());\r\n      }\r\n    }, 500);\r\n    if (!unmounted) {\r\n      if (search !== \"\") {\r\n        getLocations(search);\r\n      } else {\r\n        setPredictions([]);\r\n      }\r\n    }\r\n    return () => {\r\n      unmounted = true;\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [search]);\r\n\r\n  return (\r\n    <VStack flex={1}>\r\n      <NavBar user={user} setLogout={setLogout} />\r\n      {/* Map Block */}\r\n      <Suspense>\r\n        <Map user={user} />\r\n      </Suspense>\r\n    </VStack>\r\n  );\r\n};\r\n\r\nexport default Index;\r\n","import { v4 as uuidv4 } from \"uuid\";\r\nimport * as events from \"../events\";\r\nimport moment from \"moment-timezone\";\r\nimport { getUser, API_URL } from \"../../constants/Config\";\r\n\r\nconst setUser = (user) => {\r\n  if (user) {\r\n    // console.lo\r\n    const subscription = user.lastsub; //subscribed && user.subscribed[user.subscribed.length - 1];\r\n\r\n    // console.log(\"subscription\", subscription, user.plan);\r\n    const freetrial = user.freetrial && user.freetrial;\r\n\r\n    localStorage.setItem(\r\n      \"@shadowuser\",\r\n      JSON.stringify({\r\n        _id: user._id,\r\n        team: user.team,\r\n        owner: user._id === user.team,\r\n        token: user.token,\r\n        pic: user.pic ? user.pic.id : 0,\r\n        email: user.email,\r\n        firstname: user.firstname,\r\n        invitecode: user.invitecode,\r\n        lastname: user.lastname,\r\n        name: user.firstname + \" \" + user.lastname,\r\n        joined: user.created,\r\n        customerId: user.customerId,\r\n        pm: user.pm,\r\n        role: user.role,\r\n        freetrial,\r\n        sub: {\r\n          start: (subscription && subscription.start) || null,\r\n          end: (subscription && subscription.end) || null,\r\n          plan: (user.plan && user.plan.type) || null,\r\n        },\r\n        price: {\r\n          mail: (freetrial && freetrial.mail) || 0,\r\n          smartsearch: (freetrial && freetrial.smartsearch) || 0,\r\n        },\r\n      })\r\n    );\r\n  }\r\n};\r\n\r\nexport const login = (email, password) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/login`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          email: email,\r\n          password: password,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const resError = await response.json();\r\n        console.log(\"Response Error\", resError.error);\r\n\r\n        if (resError && resError.error) {\r\n          throw new Error(resError.error);\r\n        } else {\r\n          throw new Error(\"Something went wrong!\");\r\n        }\r\n      }\r\n\r\n      const resData = await response.json();\r\n      // console.log(resData.data);\r\n\r\n      const user = resData.data;\r\n      var d = new Date();\r\n      d.setFullYear(d.getFullYear() + 5);\r\n      const expirationDate = d;\r\n\r\n      setUser(user);\r\n\r\n      await dispatch(authenticate(user._id, user.token, expirationDate));\r\n\r\n      await dispatch(getProfile());\r\n\r\n      // await dispatch(planActions.fetchPlans());\r\n\r\n      // await dispatch(campaignsActions.fetchCampaigns());\r\n\r\n      // await dispatch(templatesActions.fetchTemplates());\r\n\r\n      // await dispatch(signatureActions.fetchSignatures());\r\n\r\n      // await dispatch(mapsActions.fetchStateProperties());\r\n\r\n      // await dispatch(mapsActions.fetchZipProperties());\r\n      // await dispatch(propertiesActions.fetchStatus());\r\n\r\n      // await dispatch(propertiesActions.fetchTags());\r\n\r\n      // await dispatch(pipelineActions.fetchPipelines());\r\n\r\n      // await dispatch(getFaqs());\r\n    } catch (err) {\r\n      throw new Error(err.message);\r\n    }\r\n  };\r\n};\r\n\r\nexport const forgotPassword = (email) => {\r\n  return async (dispatch) => {\r\n    const response = await fetch(`${API_URL}/forgot`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        email,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errRes = await response.json();\r\n      let message = \"Something went wrong!\";\r\n      if (errRes.error) {\r\n        message = errRes.error;\r\n      }\r\n      throw new Error(message);\r\n    }\r\n\r\n    const resData = await response.json();\r\n    if (resData.error) {\r\n      throw new Error(resData.error);\r\n    }\r\n    // console.log(\"ResData\", resData);\r\n    return resData.success;\r\n  };\r\n};\r\n\r\nexport const resetPassword = (data) => {\r\n  return async (dispatch) => {\r\n    const response = await fetch(`${API_URL}/reset`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errRes = await response.json();\r\n      let message = \"Something went wrong!\";\r\n      if (errRes.error) {\r\n        message = errRes.error;\r\n      }\r\n      throw new Error(message);\r\n    }\r\n\r\n    const resData = await response.json();\r\n    return resData.success;\r\n  };\r\n};\r\n\r\nexport const authenticate = (userId, token) => {\r\n  return (dispatch) => {\r\n    dispatch({\r\n      type: events.AUTHENTICATE,\r\n      userId: userId,\r\n      token: token,\r\n    });\r\n  };\r\n};\r\n\r\nexport const signup = async (data) => {\r\n  const url = `${API_URL}/register`;\r\n  const response = await fetch(url, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify({\r\n      ...data,\r\n      os: \"W\",\r\n      device_id: uuidv4(),\r\n    }),\r\n  });\r\n\r\n  if (!response.ok) {\r\n    const resError = await response.json();\r\n    console.log(\"Response Error\", resError.error);\r\n\r\n    if (resError && resError.error) {\r\n      throw new Error(resError.error);\r\n    } else {\r\n      throw new Error(\"Something went wrong!\");\r\n    }\r\n  }\r\n  const resData = await response.json();\r\n  return resData.data;\r\n};\r\n\r\nexport const getProfile = (check = false) => {\r\n  return async (dispatch, getState) => {\r\n    try {\r\n      const { _id, token } = getUser();\r\n      const response = await fetch(`${API_URL}/users/${_id}`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: \"Bearer \" + token,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const resError = await response.json();\r\n        // console.log(\"Response Error\", resError.error);\r\n        if (resError && resError.error) {\r\n          if (resError.error === \"token expired or invalid token\") {\r\n            localStorage.removeItem(\"@shadowuser\");\r\n          }\r\n          throw new Error(resError.error);\r\n        } else {\r\n          throw new Error(\"Something went wrong!\");\r\n        }\r\n      } else {\r\n        const resData = await response.json();\r\n        const user = resData.data;\r\n        if (!check) {\r\n          const appId = uuidv4();\r\n          dispatch({\r\n            type: events.SET_PROFILE,\r\n            data: { ...user, appId },\r\n          });\r\n\r\n          dispatch({\r\n            type: events.SET_PROPERTY_FILTER,\r\n            data: {\r\n              fromDate: moment(user.created).format(\"YYYY-MM-DD\"),\r\n              isUserFilter: false,\r\n              refresh: true,\r\n            },\r\n          });\r\n        }\r\n        if (user) {\r\n          const xuser = getUser();\r\n          if (xuser) {\r\n            setUser({ ...xuser, ...user });\r\n          }\r\n        }\r\n        return user;\r\n      }\r\n    } catch (err) {\r\n      // console.log(err);\r\n      throw new Error(err.message);\r\n      // return null;\r\n    }\r\n  };\r\n};\r\n\r\nexport const updateProfile = (data, socket = null) => {\r\n  return async (dispatch, getState) => {\r\n    const { token } = getUser();\r\n    const { _id } = data;\r\n    delete data._id;\r\n    const body = JSON.stringify(data);\r\n    const response = await fetch(`${API_URL}/users/${_id}`, {\r\n      method: \"PATCH\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: \"Bearer \" + token,\r\n      },\r\n      body,\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorResData = await response.json();\r\n      let message = \"Something went wrong!\";\r\n      console.log(errorResData);\r\n      if (errorResData.error) {\r\n        throw new Error(errorResData.error);\r\n      } else {\r\n        throw new Error(message);\r\n      }\r\n    }\r\n\r\n    const resData = await response.json();\r\n    if (resData.data) {\r\n      // console.log(\"RESDATA\", resData.data);\r\n      const user = getUser();\r\n      setUser({ ...user, ...resData.data });\r\n      if (socket) {\r\n        if (data.changerole) {\r\n          socket.emit(\"user:role:changed\", data);\r\n        }\r\n        if (data.changeactive) {\r\n          socket.emit(\"user:status:changed\", data);\r\n        }\r\n      }\r\n      dispatch({\r\n        type: events.SET_PROFILE,\r\n        data: resData.data,\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const uploadProfilePicture = (picture, setProgress) => {\r\n  return async (dispatch, getState) => {\r\n    // any async code you want!\r\n    const token = getState().auth.token;\r\n    const profile = getState().auth.profile;\r\n    const { availableProperties } = getState().properties;\r\n    const formData = new FormData();\r\n\r\n    formData.append(\"_id\", profile._id);\r\n    formData.append(\"picture\", {\r\n      type: \"image/jpg\",\r\n      uri: picture,\r\n      name: \"user_\" + profile.id + \".jpg\",\r\n    });\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open(\"POST\", `${API_URL}/users/upload/picture`, true);\r\n    xhr.addEventListener(\r\n      \"progress\",\r\n      function (e) {\r\n        var done = e.position || e.loaded,\r\n          total = e.totalSize || e.total;\r\n        dispatch({\r\n          type: events.SET_PROGRESS,\r\n          progress: Math.floor((done / total) * 1000) / 10,\r\n        });\r\n        // console.log(\r\n        //   \"xhr progress: \" + Math.floor((done / total) * 1000) / 10 + \"%\"\r\n        // );\r\n      },\r\n      false\r\n    );\r\n    if (xhr.upload) {\r\n      xhr.upload.onprogress = function (e) {\r\n        var done = e.position || e.loaded,\r\n          total = e.totalSize || e.total;\r\n        // console.log(\r\n        //   \"xhr.upload progress: \" +\r\n        //     done +\r\n        //     \" / \" +\r\n        //     total +\r\n        //     \" = \" +\r\n        //     Math.floor((done / total) * 1000) / 10 +\r\n        //     \"%\"\r\n        // );\r\n        setProgress(Math.floor((done / total) * 1000) / 10);\r\n      };\r\n    }\r\n    xhr.setRequestHeader(\"Content-Type\", \"multipart/form-data\");\r\n    xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\r\n    xhr.onreadystatechange = async function () {\r\n      if (this.readyState === 4 && this.status === 200) {\r\n        const resData = JSON.parse(this.responseText);\r\n        if (resData.data) {\r\n          // await CacheManager.addToCache({\r\n          //   file: picture,\r\n          //   key: `pp-${profile._id}`,\r\n          // })\r\n          dispatch({\r\n            type: events.SET_PROFILE,\r\n            data: resData.data,\r\n          });\r\n\r\n          const properties = availableProperties.map((p) => {\r\n            const u = resData.data;\r\n            if (p.createdUser && p.createdUser.length > 0) {\r\n              let cu = p.createdUser[0];\r\n              if (cu._id === u._id) {\r\n                cu.pic = u.pic;\r\n                p.createdUser = [cu];\r\n              }\r\n            }\r\n            return p;\r\n          });\r\n          dispatch({\r\n            type: events.SET_PROPERTIES,\r\n            properties,\r\n          });\r\n        } else {\r\n          if (resData.error) {\r\n            throw new Error(resData.error);\r\n          }\r\n        }\r\n      }\r\n    };\r\n    xhr.send(formData);\r\n  };\r\n};\r\n\r\nexport const getFaqs = () => {\r\n  return async (dispatch, getState) => {\r\n    const { token } = getUser();\r\n    try {\r\n      const response = await fetch(`${API_URL}/faqs/get`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: \"Bearer \" + token,\r\n        },\r\n        body: JSON.stringify({\r\n          skip: 0,\r\n          filter: { active: true },\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const resError = await response.json();\r\n        console.log(\"Response Error\", resError);\r\n\r\n        if (resError && resError.error) {\r\n          throw new Error(resError.error);\r\n        } else {\r\n          throw new Error(\"Something went wrong!\");\r\n        }\r\n      }\r\n      const resData = await response.json();\r\n      const faqs = resData.data;\r\n\r\n      dispatch({\r\n        type: events.SET_FAQS,\r\n        data: faqs,\r\n      });\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n};\r\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;"],"names":["NavBar","React","Map","setLogout","user","dispatch","useDispatch","useState","search","setPredictions","useEffect","authActions","unmounted","getLocations","_","loc","url","fetch","result","json","predictions","console","error","message","flex","Suspense","setUser","subscription","lastsub","freetrial","localStorage","setItem","JSON","stringify","_id","team","owner","token","pic","id","email","firstname","invitecode","lastname","name","joined","created","customerId","pm","role","sub","start","end","plan","type","price","mail","smartsearch","login","password","API_URL","method","headers","body","response","ok","resError","log","Error","resData","data","d","Date","setFullYear","getFullYear","expirationDate","authenticate","getProfile","forgotPassword","errRes","success","resetPassword","userId","events","signup","os","device_id","uuidv4","check","getState","getUser","Authorization","removeItem","appId","fromDate","moment","format","isUserFilter","refresh","xuser","updateProfile","socket","errorResData","changerole","emit","changeactive","getFaqs","skip","filter","active","faqs","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","uuid","REGEX","byteToHex","i","push","toString","substr","arr","offset","arguments","length","undefined","toLowerCase","validate","TypeError","options","buf","rnds","random"],"sourceRoot":""}
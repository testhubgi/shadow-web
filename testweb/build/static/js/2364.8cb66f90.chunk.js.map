{"version":3,"file":"static/js/2364.8cb66f90.chunk.js","mappings":"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","sources":["pages/private/account/PageHeader.js","pages/private/account/Subscriptions.js"],"sourcesContent":["import React from \"react\";\r\nimport { HStack, VStack, Text } from \"native-base\";\r\nimport { vh, vw } from \"../../../util\";\r\n\r\nconst PageHeader = ({ title, subtitle, rightElement, noborder = false }) => {\r\n  let bottomBorder = {\r\n    borderBottomColor: \"rgba(0,0,0, 0.15)\",\r\n    borderBottomWidth: vw(1.5),\r\n    marginBottom: vh(20),\r\n  };\r\n  if (noborder) {\r\n    bottomBorder = {};\r\n  }\r\n  return (\r\n    <HStack\r\n      style={{ paddingBottom: vh(16), ...bottomBorder }}\r\n      justifyContent={\"space-between\"}\r\n    >\r\n      <VStack>\r\n        <Text\r\n          style={{\r\n            fontSize: vw(24),\r\n            color: \"#303030\",\r\n            fontFamily: \"Poppins_medium\",\r\n          }}\r\n        >\r\n          {title}\r\n        </Text>\r\n        <Text\r\n          style={{\r\n            fontSize: vw(13),\r\n            color: \"#666666\",\r\n            fontFamily: \"Poppins\",\r\n          }}\r\n        >\r\n          {subtitle}\r\n        </Text>\r\n      </VStack>\r\n      {rightElement}\r\n    </HStack>\r\n  );\r\n};\r\n\r\nexport default PageHeader;\r\n","import React, { useEffect, useCallback, useRef, Suspense } from \"react\";\r\nimport { VStack, Text, Spinner } from \"native-base\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport PageHeader from \"./PageHeader\";\r\nimport { toFirstCase, vh, vw } from \"../../../util\";\r\n\r\nimport * as planActions from \"../../../store/actions/plan\";\r\nimport moment from \"moment-timezone\";\r\n\r\nconst Invoices = React.lazy(() => import(\"./Invoices\"));\r\nconst PaymentMethods = React.lazy(() => import(\"./PaymentMethods\"));\r\nconst SubscriptionPlans = React.lazy(() => import(\"./SubscriptionPlans\"));\r\n\r\nconst useMountedState = () => {\r\n  const mountedRef = useRef(false);\r\n  const isMounted = useCallback(() => mountedRef.current, []);\r\n\r\n  useEffect(() => {\r\n    mountedRef.current = true;\r\n\r\n    return () => {\r\n      mountedRef.current = false;\r\n    };\r\n  }, []);\r\n\r\n  return isMounted;\r\n};\r\n\r\nconst Subscriptions = ({ _showAlert, profile, landscape }) => {\r\n  const dispatch = useDispatch();\r\n  const isMounted = useMountedState();\r\n  const { plan } = useSelector((state) => state.plan);\r\n\r\n  const loadInit = useCallback(async () => {\r\n    try {\r\n      await dispatch(planActions.fetchPlans());\r\n    } catch (err) {\r\n      _showAlert(\"error\", \"something went wrong.\");\r\n    }\r\n  }, [dispatch, _showAlert]);\r\n\r\n  useEffect(() => {\r\n    if (isMounted) {\r\n      loadInit().then(() => {});\r\n    }\r\n  }, [dispatch, loadInit, isMounted]);\r\n\r\n  let subscribed = false;\r\n  let subPlan = null;\r\n  let subtitle = \"\";\r\n  let subDetails = null;\r\n  if (profile.lastsub && plan) {\r\n    const lastsub = profile.lastsub;\r\n    let status = \"Active\";\r\n    const duration = moment\r\n      .unix(lastsub.end)\r\n      .diff(moment.unix(lastsub.start), \"days\");\r\n\r\n    const d = moment.unix(profile.lastsub.end);\r\n    const n = d.diff(moment(), \"days\");\r\n\r\n    console.log(\"duration\", duration, lastsub.end, lastsub.start);\r\n    const start = moment.unix(lastsub.start).format(\"DD MMM YYYY\");\r\n    const end = moment.unix(lastsub.end).format(\"DD MMM YYYY\");\r\n    subPlan = plan && plan.find((p) => p.plan_id === lastsub.planid);\r\n    const card = lastsub.brand\r\n      ? toFirstCase(lastsub.brand) + \" **** \" + lastsub.card\r\n      : \"-\";\r\n    if (lastsub.cancel) {\r\n      status = \"Canceled\";\r\n      subscribed = false;\r\n      subtitle = `You're not subscribed (canceled at ${moment(\r\n        lastsub.canceledAt\r\n      ).format(\"DD MMM YYYY\")} )`;\r\n    } else if (n < 0) {\r\n      status = \"Ended\";\r\n      subscribed = false;\r\n      subtitle = `You subscription ended at ${moment.unix(lastsub.end).subtract(1, \"day\").endOf(\"month\").format(\r\n        \"DD MMM YYYY\"\r\n      )} `;\r\n    } else {\r\n      subtitle = \"You're in \" + subPlan.name + \" plan\";\r\n      subscribed = true;\r\n    }\r\n    subDetails = {\r\n      Name: subPlan.name,\r\n      Type: subPlan.type.toUpperCase(),\r\n      Billing: subPlan.period.toUpperCase(),\r\n      \"Billing Date\": end,\r\n      \"Subscription Date\": start,\r\n      Status: status,\r\n      Duration: duration + \" days remaining\",\r\n      \"Payment Method\": card,\r\n    };\r\n  } else {\r\n    if (profile.freetrial) {\r\n      subtitle =\r\n        \"You're in free trial and it ends in \" +\r\n        moment(profile.freetrial.end).format(\"MM-DD-YYYY\");\r\n    }\r\n  }\r\n\r\n  return (\r\n    <VStack>\r\n      <PageHeader title='Subscriptions' subtitle={subtitle} />\r\n\r\n      {/* Plans && subscriptions */}\r\n      <VStack\r\n        style={{\r\n          boxShadow: \"0px 3px 10px #0000001A\",\r\n          borderRadius: 10,\r\n          backgroundColor: \"white\",\r\n          paddingVertical: vh(20),\r\n          paddingHorizontal: vw(20),\r\n        }}\r\n      >\r\n        <Suspense fallback={<Spinner />}>\r\n          <SubscriptionPlans\r\n            _showAlert={_showAlert}\r\n            profile={profile}\r\n            landscape={landscape}\r\n          />\r\n        </Suspense>\r\n        {/* Payment Methods */}\r\n        <VStack style={{ marginTop: vh(20) }}>\r\n          <Text\r\n            style={{\r\n              fontSize: vw(13),\r\n              fontFamily: \"Poppins_medium\",\r\n              color: \"#303030\",\r\n            }}\r\n          >\r\n            Payment methods\r\n          </Text>\r\n          <Suspense fallback={<Spinner />}>\r\n            <PaymentMethods\r\n              landscape={landscape}\r\n              profile={profile}\r\n              _showAlert={_showAlert}\r\n            />\r\n          </Suspense>\r\n        </VStack>\r\n      </VStack>\r\n      {/* History */}\r\n      <Suspense fallback={<Spinner />}>\r\n        <Invoices _showAlert={_showAlert} />\r\n      </Suspense>\r\n    </VStack>\r\n  );\r\n};\r\n\r\nexport default Subscriptions;\r\n"],"names":["title","subtitle","rightElement","noborder","bottomBorder","borderBottomColor","borderBottomWidth","vw","marginBottom","vh","style","paddingBottom","justifyContent","fontSize","color","fontFamily","Invoices","React","PaymentMethods","SubscriptionPlans","_showAlert","profile","landscape","dispatch","useDispatch","isMounted","mountedRef","useRef","useCallback","current","useEffect","useMountedState","plan","useSelector","state","loadInit","planActions","then","subPlan","lastsub","status","duration","moment","end","diff","start","n","console","log","format","find","p","plan_id","planid","card","brand","toFirstCase","cancel","canceledAt","subtract","endOf","name","Name","Type","type","toUpperCase","Billing","period","Status","Duration","freetrial","boxShadow","borderRadius","backgroundColor","paddingVertical","paddingHorizontal","Suspense","fallback","marginTop"],"sourceRoot":""}